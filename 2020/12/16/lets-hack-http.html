<!DOCTYPE html>
<html lang="en-US">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Let&#8217;s Hack HTTP</title>
    <meta name="description"
        content="">
    <link rel="canonical" href="https://mattrighetti.github.io/2020/12/16/lets-hack-http.html">
    <link rel="alternate" type="application/rss+xml" title="mattrighetti"
        href="https://mattrighetti.github.io/feed.xml">

    <link rel="stylesheet" href=" /css/font.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.4.0/css/font-awesome.min.css">
    <link rel="stylesheet" href=" /css/style.css">
    <link rel="stylesheet" href=" /css/code.css">
</head>

<body class="mx-auto max-width">
    <header class="mx-auto site-header">
        <nav>
            <a class="-title" href="/">mattrighetti</a>
            
            
            
            
            
            
            
            <a href="/about.html">About</a>
            
            
            
            
            
            
            
            
            
            <a href="/projects.html">Projects</a>
            
            
            
            
            
            <a href="/resume.html">Resume</a>
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
        </nav>
    </header>

    <main>
        <article>
  <h1>Let&#8217;s Hack HTTP</h1>
  <div class="post-meta sect1">Dec 16, 2020</div>
  <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>In this article Iâ€™m going to show you why you absolutely want to ditch
<a href="https://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol">HTTP</a> websites by
impersonating an attacker that has targeted you.</p>
</div>
<div class="openblock warn">
<div class="content">
<div class="paragraph">
<p><strong>This article is for educational purposes only. Do not try this with people
that didnâ€™t explicitly give you permission to do so.</strong></p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="what-you-will-learn">What you will learn</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This article should give you a better understanding of
why HTTP is bad and why you should avoid it. Also youâ€™ll learn a few different
tools that are common in the IT world.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="tools">Tools</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Weâ€™re going to use some well known pen-testing tools to make this
happen:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>nmap</strong></p>
</li>
<li>
<p><strong>ettercap</strong></p>
</li>
<li>
<p><strong>WireShark</strong></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="initial-phase">Initial Phase</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Our attack is useless if we donâ€™t have anyone to hack, so what
an attacker would do first is actually FIND you in the network. Thatâ€™s what
<strong>nmap</strong> is famous for. What <strong>nmap</strong> will do is scan the entire network and
look for connected hosts which we can potentially attack.</p>
</div>
<div class="paragraph">
<p>Iâ€™m going to scan my home network with <strong>nmap</strong> but before that I need my local
IP address</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="https://miro.medium.com/max/1400/1*624dbYbYnjAKpdcnSjDtrA.png" alt="1*624dbYbYnjAKpdcnSjDtrA">
</div>
</div>
<div class="paragraph">
<p>Great, now I know that my local IP is <strong>192.168.1.151</strong> and the subnet mask is
<strong>255.255.255.0</strong>, thatâ€™s all I need to performa a network exploration with
<strong>nmap</strong></p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="https://miro.medium.com/max/1400/1*0jUZSMofWAsMZbNHuZrZYQ.png" alt="1*0jUZSMofWAsMZbNHuZrZYQ">
</div>
</div>
<div class="paragraph">
<p>As you can see I provided nmap with the IPs to scan in the network, which in
this case are all the addresses that go from <strong>192.168.1.1</strong> to
<strong>192.168.1.254</strong>, the flag -sn will make nmap try to determine whether the
specified hosts are up and what are their names.</p>
</div>
<div class="paragraph">
<p>My target is going to be my iMac thatâ€™s sitting next to me, its IP address is
<strong>192.168.1.195</strong>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="packet-sniffing">Packet Sniffing</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Now that we have our target we need to sniff his/her HTTP
packets. Since weâ€™re all connected to a router at the moment, weâ€™re going to see
nothing useful in WireShark because my iMacâ€™s packets are not sent directly to
me, the router will just send those packets to my iMac.</p>
</div>
<div class="paragraph">
<p>How are we going to make those packets come to us then if the router will just
send them to my iMac? This can be performed with a well known attack called
<a href="https://en.wikipedia.org/wiki/Man-in-the-middle_attack">MITM</a> (Man In The Middle)
that will make all those packets pass through us before reaching his intended
destination.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="https://miro.medium.com/max/1400/1*YGsEp-aWVhkUe2JAIq-3Lw.png" alt="1*YGsEp aWVhkUe2JAIq 3Lw">
</div>
</div>
<div class="paragraph">
<p>You might be wondering what <strong>ettercap</strong> is doing here, let me explain.</p>
</div>
<div class="paragraph">
<p>Every router relies heavily on <a href="https://en.wikipedia.org/wiki/Address_Resolution_Protocol">ARP</a>,
(Address Resolution Protocol), to know where devices are on the
network. It basically links every MAC address (which never changes) to its
device IP address. What <strong>ettercap</strong> here is basically doing is called
<a href="https://en.wikipedia.org/wiki/ARP_spoofing">ARP poisoning</a>,
which Iâ€™m using to make the router think that I am the victimâ€™s
computer so that it will send all the packets intended for my iMac to me, and
Iâ€™m also telling the iMac that I am the router so it should send all the packets
to me. Starting to see the bigger picture? ðŸ™ƒ</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="https://miro.medium.com/max/1400/1*-gwmGLi8rn__ZlYKWAIgUw.png" alt="1* gwmGLi8rn  ZlYKWAIgUw">
</div>
</div>
<div class="paragraph">
<p>These are all the packets that are going through my iMac to the router and from
the router to the iMac. Luckily this will mostly be encrypted stuff, but guess
what, HTTP is not. Letâ€™s move to WireShark so we can capture and filter all the
packets that we need. While ettercap is still going, Iâ€™m going to capture
packets with WireShark and at the same moment Iâ€™m going to use my iMac to
navigate to an <a href="http://www.bio.acousti.ca/">unsecured website</a> which is just a
dummy site that uses HTTP.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="https://miro.medium.com/max/1400/1*PlyWovxZ3PnvQrUQXSdlrQ.png" alt="1*PlyWovxZ3PnvQrUQXSdlrQ">
</div>
</div>
<div class="paragraph">
<p>I also did filter packets by IP and HTTP protocol to have a better understanding
of what I captured. Now WireShark will help me put those pieces together, if I
right click on one of those HTTP packets and select <strong>Follow &gt; HTTP stream</strong>
Iâ€™ll get everything of what the victim browsed in cleartext.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="https://miro.medium.com/max/1400/1*zVyWd7VriRIN9YUcUFWMIQ.png" alt="1*zVyWd7VriRIN9YUcUFWMIQ">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="https://miro.medium.com/max/1400/1*RjUQgaCyOi1EFg32vZ5p0A.png" alt="1*RjUQgaCyOi1EFg32vZ5p0A">
</div>
</div>
<div class="paragraph">
<p>From here I can see everything the victim did on that site, I could grab his
login credentials when he/she tries to log in and every other possible bad thing
that pops to my mind.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="conclusion">Conclusion</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Now you know that when you are browsing on an insecure website,
even worse on a public network, keep in mind that you are not safe and bad guys
could be watching every step that you make.</p>
</div>
</div>
</div>
</article>
<script>
    function renderCodeTags() {
        const collection = document.getElementsByClassName("rouge highlight");

        for (let i = 0; i < collection.length; i++) {
        let cNode = collection[i].firstChild;
        let lang = cNode.getAttribute("data-lang");
        
        let newNode = document.createElement("div");
        newNode.className = "lang-tag";
        newNode.innerHTML += lang;
        
        collection[i].insertBefore(newNode, cNode);
        }
    }

    renderCodeTags()
</script>
    </main>

    <footer class="site-footer">
        <p>
            <a href=" /feed.xml">
                <i class="fa fa-rss"></i> rss
            </a>

            <a href="https://github.com/mattrighetti">
                <i class="fa fa-github"></i> mattrighetti
            </a>
        </p>
    </footer>

</body>

</html>